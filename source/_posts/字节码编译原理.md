title: 字节码编译原理
author: jianghe
tags:
  - jvm
categories:
  - java
date: 2021-01-29 16:44:00
---
### 字节码
> 一次编译，处处运行(write once,run anywhere)

### 1. 前端编译器
> 将java源码编译为字节码，前端编译器不会直接涉及编译优化等方面的技术，而是将这些具体的细节移交给Hotspot的Jit编译器负责。
- javac
	- 配置在“PATH”环境变量中的javac编译器
	- 全量式编译
- ECJ（eclipse compiler for java）
	- eclipse使用的前端编译器是自主研发的
	- 增量式编译，每次保存时编译方案是把未编译部分的源码逐行进行编译，效率高效，编译的质量也和javac相比大致还是一致的
	- 其中tomcat编译jsp也是通过ECJ方式来编译，ECJ编译器也是开源的
    
    
### 2. 编译原理
> javac编译器在将java源码编译为一个有效的字节码文件
> 主要的步骤：词法解析->语法解析->语义解析->生成字节码


![2](/images/pasted-10.png)

#### 2.1 词法分析
将java源码中的关键字和标示符等内容转换为符合java语法规范的token序列，然后按照指定的顺序规则进行匹配校验

#### 2.2 语法分析
将词法分析后的token序列整合为一颗结构化的抽象语法树，例如try后面会接catch然后再接finally子句

#### 2.3 语义分析
由于语法解析出来的抽象语法树并不能直接应用于生成字节码文件，这是因为这颗语法树相对来说还不是很完善，那语义分析就是将语法树扩充的更加完善，后续编译器将会使用语义解析后的语法树来生成字节码